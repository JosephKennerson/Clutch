<h1>Events Search</h1>

<%= form_for search_path, method: :get do |event| %>
  <p>
    <%= event.label "Search for events" %>
    <%= text_field_tag :q, params[:q] %>
    <%= submit_tag "Search events", name: nil %>
  </p>
<% end %>

<ul class="list-group">
  <% @events.each do |event| %>
    <li class="list-group-item">
      <h3>
        <%= link_to event.try(:highlight).try(:name) ? event.highlight.name[0].html_safe : event.name,
          controller: "events",
          action: "show",
          id: event._id%>
      </h3>
      <% if event.try(:highlight).try(:text) %>
        <% event.highlight.text.each do |snippet| %>
          <p><%= snippet.html_safe %>...</p>
        <% end %>
      <% end %>
    </li>
  <% end %>
</ul>